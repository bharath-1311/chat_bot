steps:
- name: 'gcr.io/cloud-builders/gcloud'
  entrypoint: 'bash'
  args:
    - '-c'
    - |
      gcloud config set project lumen-b-ctl-047
      gcloud config set compute/region us-central1
      gcloud config set compute/zone us-central1-a
      gcloud config set container/cluster chatbot

- name: 'gcr.io/cloud-builders/docker'
  args:
    - 'build'
    - '-t'
    - 'gcr.io/lumen-b-ctl-047/chat_bot1:$SHORT_SHA'
    - '.'

- name: 'gcr.io/cloud-builders/docker'
  args:
    - 'push'
    - 'gcr.io/lumen-b-ctl-047/chat_bot1:$SHORT_SHA'

- name: 'gcr.io/cloud-builders/kubectl'
  args:
    - 'set'
    - 'image'
    - 'deployment/chat_bot7'
    - 'chat_bot1=gcr.io/lumen-b-ctl-047/chat_bot1:$SHORT_SHA'
    - '--namespace=default'

images:
- 'gcr.io/lumen-b-ctl-047/chat_bot1:$SHORT_SHA'
